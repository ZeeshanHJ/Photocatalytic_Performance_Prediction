This code is mainly taken and modified from PDPbox repository